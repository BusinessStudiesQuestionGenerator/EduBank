<!-- Previous code I deleted "This handles one question at a time, they said that due to the format of the web app code,
Cloudflare is showing my code as an array, rather than single objects, this may be why 
it is undefined"-->

<!--Chatgpt says this code should be able to handle the array properly-->

<!--This is a second attempt at handling arrays by checking if the response is an array.
This one only does one question at a time -->

<!-- This code allows you to generate several question rather than just 1 -->
<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Question Generator</title>

    <style>
        #questionDisplay {
            width: 60%;  /* Adjust width as needed */
            margin: 20px auto;
            padding: 15px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            min-height: 50px; /* Ensure it has some height even when empty */
            max-height: 400px; /* Optional: Set max height to prevent excessive expansion */
            overflow-y: auto; /* Adds a scrollbar if there are too many questions */
        }
    </style>
    
    <script>
        async function loadQuestions() {
            try {
                let response = await fetch("https://little-frog-4a3f.robothu21.workers.dev/");
                if (!response.ok) {
                    throw new Error("Failed to fetch questions");
                }
                let data = await response.json();

                if (!Array.isArray(data) || data.length === 0) {
                    throw new Error("No questions found");
                }

                // Get the selected number of questions from the dropdown
                let numQuestions = parseInt(document.getElementById("questionCount").value);

                // Shuffle the questions and get the desired amount
                let shuffledQuestions = data.sort(() => Math.random() - 0.5).slice(0, numQuestions);

                // Display the questions
                let questionContainer = document.getElementById("questionDisplay");
                questionContainer.innerHTML = ""; // Clear previous questions
                
                shuffledQuestions.forEach((q, index) => {
                    let questionElement = document.createElement("p");
                    questionElement.innerText = `${index + 1}. ${q.question}`;
                    questionContainer.appendChild(questionElement);
                });

            } catch (error) {
                console.error("Error fetching question:", error);
                document.getElementById("questionDisplay").innerText = "Error loading questions.";
            }
        }
    </script>
</head>


<body onload="loadQuestions()">
    <h1>Random Question Generator</h1>
-->
    <!-- Dropdown for selecting the number of questions -->
<!--
    <label for="questionCount">Number of Questions:</label>
    <select id="questionCount">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="5">5</option>
        <option value="10">10</option>
    </select>

    <button onclick="loadQuestions()">Get New Questions</button>
-->
    <!-- Container to display the questions -->
<!--
    <div id="questionDisplay"></div>
</body>
</html>
-->

<!-- Version 2 of the code above, so that we can select multiple questions -->
<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Question Generator</title>

    <style>
        #questionDisplay {
            width: 60%;  
            margin: 20px auto;
            padding: 15px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            min-height: 50px; 
            max-height: 400px; 
            overflow-y: auto; 
        }

        #questionDisplay p {
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
    </style>
    
    <script>
        async function loadQuestions() {
            try {
                let response = await fetch("https://little-frog-4a3f.robothu21.workers.dev/");
                if (!response.ok) {
                    throw new Error("Failed to fetch questions");
                }
                let data = await response.json();

                if (!Array.isArray(data) || data.length === 0) {
                    throw new Error("No questions found");
                }

                // Get the selected number of questions from localStorage or dropdown
                let numQuestions = parseInt(document.getElementById("questionCount").value);

                // Shuffle and display questions
                let shuffledQuestions = data.sort(() => Math.random() - 0.5).slice(0, numQuestions);
                let questionContainer = document.getElementById("questionDisplay");
                questionContainer.innerHTML = "";

                shuffledQuestions.forEach((q, index) => {
                    let questionElement = document.createElement("p");
                    questionElement.innerText = `${index + 1}. ${q.question}`;
                    questionContainer.appendChild(questionElement);
                });

            } catch (error) {
                console.error("Error fetching question:", error);
                document.getElementById("questionDisplay").innerText = "Error loading questions.";
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            let dropdown = document.getElementById("questionCount");
            
            // Retrieve last selected value or default to 1
            let storedValue = localStorage.getItem("questionCount") || "1";
            dropdown.value = storedValue;

            // Ensure questions load with the stored selection on refresh
            loadQuestions();

            // Save selection when changed
            dropdown.addEventListener("change", () => {
                localStorage.setItem("questionCount", dropdown.value);
                loadQuestions(); // Load new number of questions immediately
            });
        });
    </script>
</head>
<body>
    <h1>Random Question Generator</h1>
    
    <label for="questionCount">Number of Questions:</label>
    <select id="questionCount">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="5">5</option>
        <option value="10">10</option>
    </select>

    <button onclick="loadQuestions()">Get New Questions</button>
    
    <div id="questionDisplay"></div>
</body>
</html>
-->

<!-- This code is for handling multiple topics and number of questions-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Question Generator</title>
    <script>
        let allQuestions = []; // Store all questions globally

        async function fetchQuestions() {
            try {
                let response = await fetch("https://little-frog-4a3f.robothu21.workers.dev/"); // Replace with your Cloudflare URL
                if (!response.ok) {
                    throw new Error("Failed to fetch questions");
                }
                allQuestions = await response.json();

                if (!Array.isArray(allQuestions) || allQuestions.length === 0) {
                    throw new Error("No questions found");
                }

                populateTopics(); // Populate the topics dropdown
                loadQuestions(); // Load questions initially

            } catch (error) {
                console.error("Error fetching questions:", error);
                document.getElementById("questionDisplay").innerText = "Error loading questions.";
            }
        }

        function populateTopics() {
            let topicDropdown = document.getElementById("topicFilter");
            let uniqueTopics = [...new Set(allQuestions.map(q => q.topic))]; // Get unique topics

            topicDropdown.innerHTML = ""; // Clear existing options

            // Always include "All Topics" as the first option
            let allOption = document.createElement("option");
            allOption.value = "all";
            allOption.innerText = "All Topics";
            topicDropdown.appendChild(allOption);

            // Add unique topics from the dataset
            uniqueTopics.forEach(topic => {
                if (topic) { // Ensure topic is not empty
                    let option = document.createElement("option");
                    option.value = topic;
                    option.innerText = topic;
                    topicDropdown.appendChild(option);
                }
            });
        }

        function loadQuestions() {
            let numQuestions = parseInt(document.getElementById("questionCount").value);
            let selectedTopic = document.getElementById("topicFilter").value;

            // Filter questions based on the selected topic
            let filteredQuestions = selectedTopic === "all" ? allQuestions : allQuestions.filter(q => q.topic === selectedTopic);

            // Shuffle and select the desired number of questions
            let selectedQuestions = filteredQuestions.sort(() => Math.random() - 0.5).slice(0, numQuestions);

            let questionContainer = document.getElementById("questionDisplay");
            questionContainer.innerHTML = ""; // Clear previous questions

            selectedQuestions.forEach((q, index) => {
                let questionElement = document.createElement("p");
                questionElement.innerText = `${index + 1}. ${q.question}`;
                questionContainer.appendChild(questionElement);
            });
        }
    </script>
</head>
<body onload="fetchQuestions()">
    <h1>Random Question Generator</h1>

    <!-- Dropdown for selecting the number of questions -->
    <label for="questionCount">Number of Questions:</label>
    <select id="questionCount" onchange="loadQuestions()">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="5">5</option>
        <option value="10">10</option>
    </select>

    <!-- Dropdown for filtering by topic -->
    <label for="topicFilter">Select Topic:</label>
    <select id="topicFilter" onchange="loadQuestions()">
        <option value="all">All Topics</option> <!-- Default option -->
    </select>

    <button onclick="loadQuestions()">Get New Questions</button>

    <!-- Container to display the questions -->
    <div id="questionDisplay"></div>
</body>
</html>

