<!-- Previous code I deleted "This handles one question at a time, they said that due to the format of the web app code,
Cloudflare is showing my code as an array, rather than single objects, this may be why 
it is undefined"-->

<!--Chatgpt says this code should be able to handle the array properly-->

<!--This is a second attempt at handling arrays by checking if the response is an array.
This one only does one question at a time -->

<!-- This code allows you to generate several question rather than just 1 -->

<!-- Version 2 of the code above, so that we can select multiple questions -->
<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Question Generator</title>

    <style>
        #questionDisplay {
            width: 60%;  
            margin: 20px auto;
            padding: 15px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            min-height: 50px; 
            max-height: 400px; 
            overflow-y: auto; 
        }

        #questionDisplay p {
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
    </style>
    
    <script>
        /*
        async function loadQuestions() {
            try {
                let response = await fetch("https://little-frog-4a3f.robothu21.workers.dev/");
                if (!response.ok) {
                    throw new Error("Failed to fetch questions");
                }
                let data = await response.json();

                if (!Array.isArray(data) || data.length === 0) {
                    throw new Error("No questions found");
                }

                // Get the selected number of questions from localStorage or dropdown
                let numQuestions = parseInt(document.getElementById("questionCount").value);

                // Shuffle and display questions
                let shuffledQuestions = data.sort(() => Math.random() - 0.5).slice(0, numQuestions);
                let questionContainer = document.getElementById("questionDisplay");
                questionContainer.innerHTML = "";

                shuffledQuestions.forEach((q, index) => {
                    let questionElement = document.createElement("p");
                    questionElement.innerText = `${index + 1}. ${q.question}`;
                    questionContainer.appendChild(questionElement);
                });

            } catch (error) {
                console.error("Error fetching question:", error);
                document.getElementById("questionDisplay").innerText = "Error loading questions.";
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            let dropdown = document.getElementById("questionCount");
            
            // Retrieve last selected value or default to 1
            let storedValue = localStorage.getItem("questionCount") || "1";
            dropdown.value = storedValue;

            // Ensure questions load with the stored selection on refresh
            loadQuestions();

            // Save selection when changed
            dropdown.addEventListener("change", () => {
                localStorage.setItem("questionCount", dropdown.value);
                loadQuestions(); // Load new number of questions immediately
            });
        });
        */
    </script>
</head>
<body>
    <h1>Random Question Generator</h1>
    
    <label for="questionCount">Number of Questions:</label>
    <select id="questionCount">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="5">5</option>
        <option value="10">10</option>
    </select>

    <button onclick="loadQuestions()">Get New Questions</button>
    
    <div id="questionDisplay"></div>
</body>
</html>
-->

<!-- Fixed up code for choice of topics and number of questions, and so that there is a container around the questions-->
<!--
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Question Generator</title>
    
    <style>
        #questionDisplay {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            background-color: #f4f4f4;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            max-width: 600px;
            margin: 20px auto;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #controls {
            text-align: center;
            margin-bottom: 20px;
        }

        select, button {
            margin: 10px;
            padding: 8px;
            font-size: 16px;
        }
    </style>
    
    <script>
        /*
        let allQuestions = []; // Store all questions globally

        async function fetchQuestions() {
            try {
                let response = await fetch("https://little-frog-4a3f.robothu21.workers.dev/"); // Replace with your Cloudflare URL
                if (!response.ok) {
                    throw new Error("Failed to fetch questions");
                }
                allQuestions = await response.json();
                // console.log(allQuestions);  // Check if data is loaded correctly

                if (!Array.isArray(allQuestions) || allQuestions.length === 0) {
                    throw new Error("No questions found");
                }

                populateTopics(); // Populate the topics dropdown
                loadQuestions(); // Load questions initially

            } catch (error) {
                console.error("Error fetching questions:", error);
                document.getElementById("questionDisplay").innerText = "Error loading questions.";
            }
        }

        function populateTopics() {
            let topicDropdown = document.getElementById("topicFilter");
            let uniqueTopics = [...new Set(allQuestions.map(q => q.topic))]; // Get unique topics

            topicDropdown.innerHTML = ""; // Clear existing options

            // Always include "All Topics" as the first option
            let allOption = document.createElement("option");
            allOption.value = "all";
            allOption.innerText = "All Topics";
            topicDropdown.appendChild(allOption);

            // Add unique topics from the dataset
            uniqueTopics.forEach(topic => {
                if (topic) { // Ensure topic is not empty
                    let option = document.createElement("option");
                    option.value = topic;
                    option.innerText = topic;
                    topicDropdown.appendChild(option);
                }
            });
        }

        function loadQuestions() {
            let numQuestions = parseInt(document.getElementById("questionCount").value);
            let selectedTopic = document.getElementById("topicFilter").value;

            // Filter questions based on the selected topic
            let filteredQuestions = selectedTopic === "all" ? allQuestions : allQuestions.filter(q => q.topic === selectedTopic);

            // Shuffle and select the desired number of questions
            let selectedQuestions = filteredQuestions.sort(() => Math.random() - 0.5).slice(0, numQuestions);

            let questionContainer = document.getElementById("questionDisplay");
            questionContainer.innerHTML = ""; // Clear previous questions

            selectedQuestions.forEach((q, index) => {
                let questionElement = document.createElement("p");
                questionElement.innerText = `${index + 1}. ${q.question}`;
                questionContainer.appendChild(questionElement);
            });
        }
        */
    </script>
</head>
<body onload="fetchQuestions()">
    <h1>Random Question Generator</h1>

    <div id="controls">
-->
        <!-- Dropdown for selecting the number of questions -->
<!--
        <label for="questionCount">Number of Questions:</label>
        <select id="questionCount" onchange="loadQuestions()">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="5">5</option>
            <option value="10">10</option>
        </select>
-->
        <!-- Dropdown for filtering by topic -->
<!--
        <label for="topicFilter">Select Topic:</label>
        <select id="topicFilter" onchange="loadQuestions()">
            <option value="all">All Topics</option> 
--> 
    <!-- Default option -->
<!--
        </select>

        <button onclick="loadQuestions()">Get New Questions</button>
    </div>
-->
    <!-- Container to display the questions -->
<!--
    <div id="questionDisplay"></div>
</body>
</html>
-->

<!-- This now allows the user to select the question style they want, such as MCQ, SAQ, etc. As well
as choice of how many questions + topic choice -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Question Generator</title>
    
    <style>
        #questionDisplay {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            background-color: #f4f4f4;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            max-width: 600px;
            margin: 20px auto;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #controls {
            text-align: center;
            margin-bottom: 20px;
        }

        select, button {
            margin: 10px;
            padding: 8px;
            font-size: 16px;
        }

        nav {
            background-color: red;
            padding: 10px 0;
            text-align: center;
        }

        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        nav ul li {
            display: inline;
            margin: 0 15px;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
        }

        nav ul li a:hover {
            text-decoration: underline;
        }
    </style>
    
    <script>
        let allQuestions = []; // Store all questions globally

        async function fetchQuestions() {
            try {
                let response = await fetch("https://little-frog-4a3f.robothu21.workers.dev/"); // Replace with your Cloudflare URL
                if (!response.ok) {
                    throw new Error("Failed to fetch questions");
                }
                allQuestions = await response.json();

                if (!Array.isArray(allQuestions) || allQuestions.length === 0) {
                    throw new Error("No questions found");
                }

                populateTopics(); // Populate the topics dropdown
                populateTypes(); // Populate the question type dropdown
                loadQuestions(); // Load questions initially

            } catch (error) {
                console.error("Error fetching questions:", error);
                document.getElementById("questionDisplay").innerText = "Error loading questions.";
            }
        }

        function populateTopics() {
            let topicDropdown = document.getElementById("topicFilter");
            let uniqueTopics = [...new Set(allQuestions.map(q => q.topic))]; // Get unique topics

            topicDropdown.innerHTML = ""; // Clear existing options

            // Always include "All Topics" as the first option
            let allOption = document.createElement("option");
            allOption.value = "all";
            allOption.innerText = "All Topics";
            topicDropdown.appendChild(allOption);

            // Add unique topics from the dataset
            uniqueTopics.forEach(topic => {
                if (topic) { // Ensure topic is not empty
                    let option = document.createElement("option");
                    option.value = topic;
                    option.innerText = topic;
                    topicDropdown.appendChild(option);
                }
            });
        }

        function populateTypes() {
            let typeDropdown = document.getElementById("typeFilter");
            let uniqueTypes = [...new Set(allQuestions.map(q => q.type))]; // Get unique types

            typeDropdown.innerHTML = ""; // Clear existing options

            // Always include "All Types" as the first option
            let allOption = document.createElement("option");
            allOption.value = "all";
            allOption.innerText = "All Types";
            typeDropdown.appendChild(allOption);

            // Add unique types from the dataset
            uniqueTypes.forEach(type => {
                if (type) { // Ensure type is not empty
                    let option = document.createElement("option");
                    option.value = type;
                    option.innerText = type;
                    typeDropdown.appendChild(option);
                }
            });
        }

        function loadQuestions() {
            let numQuestions = parseInt(document.getElementById("questionCount").value);
            let selectedTopic = document.getElementById("topicFilter").value;
            let selectedType = document.getElementById("typeFilter").value;

            // Filter questions based on the selected topic and type
            let filteredQuestions = allQuestions.filter(q => {
                let topicMatch = selectedTopic === "all" || q.topic === selectedTopic;
                let typeMatch = selectedType === "all" || q.type === selectedType;
                return topicMatch && typeMatch;
            });

            // Shuffle and select the desired number of questions
            let selectedQuestions = filteredQuestions.sort(() => Math.random() - 0.5).slice(0, numQuestions);

            let questionContainer = document.getElementById("questionDisplay");
            questionContainer.innerHTML = ""; // Clear previous questions

            selectedQuestions.forEach((q, index) => {
                let questionElement = document.createElement("p");
                questionElement.innerText = `${index + 1}. ${q.question}`;
                questionContainer.appendChild(questionElement);
            });
        }
    </script>
</head>
<body onload="fetchQuestions()">
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="generate-questions.html">Generate Questions</a></li>
            <li><a href="generate-full-papers.html">Generate Full Papers</a></li>
            <li><a href="hsc-past-papers.html">HSC Past Papers</a></li>
        </ul>
    </nav>
    <h1>Random Question Generator</h1>

    <div id="controls">
        <!-- Dropdown for selecting the number of questions -->
        <label for="questionCount">Number of Questions:</label>
        <select id="questionCount" onchange="loadQuestions()">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="5">5</option>
            <option value="10">10</option>
        </select>

        <!-- Dropdown for filtering by topic -->
        <label for="topicFilter">Select Topic:</label>
        <select id="topicFilter" onchange="loadQuestions()">
            <option value="all">All Topics</option> <!-- Default option -->
        </select>

        <!-- Dropdown for filtering by question type -->
        <label for="typeFilter">Select Question Type:</label>
        <select id="typeFilter" onchange="loadQuestions()">
            <option value="all">All Types</option> <!-- Default option -->
        </select>

        <button onclick="loadQuestions()">Get New Questions</button>
    </div>

    <!-- Container to display the questions -->
    <div id="questionDisplay"></div>
</body>
</html>


